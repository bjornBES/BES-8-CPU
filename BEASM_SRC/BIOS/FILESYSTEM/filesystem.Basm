; arg 1 Disk Stack
; arg 2 Sector Stack
; arg 3 Page Stack
; return Word in ZX
.global ReadSector:

mov AX #NULL
mov AX #KW_BS
mov AX #10010b

pushr
; here we push all the registers on to the stack
; push Y X MB ZX DX CX BX AX

mov ZX SP
add SP #8

pop Y   ; Page
pop XL  ; Sector
pop XH  ; Disk

; write to the disk header
outb #10h Y

; write to the disk
add XH #11h
outb XH XL
; 0x200 bytes

mov ZX XL
mul ZX #200h

pop Y
pop X
mov AX ZX
pop ZX
mov ZX AX
pop DX
pop CX
pop BX
pop AX

ret #3
